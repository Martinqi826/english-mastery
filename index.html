<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>English Mastery - è‹±è¯­è¿›é˜¶å¤§å¸ˆ</title>
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="page-wrapper">
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <span class="logo-icon">ğŸ¯</span>
            <span>English Mastery</span>
          </div>
          <div class="header-right">
            <div class="day-badge" id="dayBadge">Day 1 / 30</div>
            <div class="user-menu" id="userMenu">
              <button class="user-btn" onclick="toggleUserDropdown()">
                <span class="user-avatar" id="userAvatar">ğŸ‘¤</span>
                <span class="user-name" id="userName">ç”¨æˆ·</span>
                <span class="dropdown-arrow">â–¼</span>
              </button>
              <div class="user-dropdown" id="userDropdown">
                <div class="dropdown-header">
                  <span class="dropdown-email" id="userEmail">user@example.com</span>
                </div>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item" onclick="handleLogout()">
                  <span>ğŸšª</span> é€€å‡ºç™»å½•
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
      <div class="container">
        <ul class="nav-list">
          <li class="nav-item">
            <a href="index.html" class="nav-link active">
              <span>ğŸ“Š</span> ä»ªè¡¨ç›˜
            </a>
          </li>
          <li class="nav-item">
            <a href="pages/vocabulary.html" class="nav-link">
              <span>ğŸ“–</span> è¯æ±‡å­¦ä¹ 
            </a>
          </li>
          <li class="nav-item">
            <a href="pages/listening.html" class="nav-link">
              <span>ğŸ‘‚</span> å¬åŠ›è®­ç»ƒ
            </a>
          </li>
          <li class="nav-item">
            <a href="pages/reading.html" class="nav-link">
              <span>ğŸ“š</span> é˜…è¯»ç»ƒä¹ 
            </a>
          </li>
          <li class="nav-item">
            <a href="pages/writing.html" class="nav-link">
              <span>âœï¸</span> å†™ä½œç»ƒä¹ 
            </a>
          </li>
          <li class="nav-item">
            <a href="pages/test.html" class="nav-link">
              <span>ğŸ¯</span> æµ‹è¯•è¯„ä¼°
            </a>
          </li>
          <li class="nav-item">
            <a href="pages/calendar.html" class="nav-link">
              <span>ğŸ“…</span> æ‰“å¡æ—¥å†
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <div class="dashboard-grid">
          <!-- Main Column -->
          <div class="dashboard-main">
            <!-- Progress Card -->
            <div class="card animate-slide-up">
              <div class="card-header">
                <h2 class="card-title">
                  <span>ğŸ“ˆ</span> æ€»ä½“è¿›åº¦
                </h2>
                <span class="level-badge level-b2" id="levelBadge">B2 æ—¥å¸¸æ°´å¹³</span>
              </div>
              <div class="card-body">
                <div class="progress-container">
                  <div class="progress-header">
                    <span class="progress-label">è·ç¦»ç›®æ ‡ C1-C2 æ°´å¹³</span>
                    <span class="progress-value" id="overallProgress">40%</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 40%"></div>
                  </div>
                  <div class="progress-info">
                    <span>èµ·ç‚¹: B1-B2</span>
                    <span>ç›®æ ‡: C1-C2 (æ¯è¯­æ°´å¹³)</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid animate-slide-up">
              <div class="stat-card">
                <div class="stat-icon">ğŸ”¥</div>
                <div class="stat-value" id="streakDays">0</div>
                <div class="stat-label">è¿ç»­æ‰“å¡å¤©æ•°</div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">âœ…</div>
                <div class="stat-value" id="todayTasks">0/5</div>
                <div class="stat-label">ä»Šæ—¥å®Œæˆä»»åŠ¡</div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">ğŸ“š</div>
                <div class="stat-value" id="wordsLearned">0</div>
                <div class="stat-label">å·²å­¦è¯æ±‡</div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">â±ï¸</div>
                <div class="stat-value" id="totalTime">0h</div>
                <div class="stat-label">ç´¯è®¡å­¦ä¹ æ—¶é•¿</div>
              </div>
            </div>

            <!-- Today's Tasks -->
            <div class="card tasks-section animate-slide-up">
              <div class="card-header">
                <h2 class="card-title">
                  <span>ğŸ¯</span> ä»Šæ—¥ä»»åŠ¡
                </h2>
                <span class="text-muted" id="taskProgress">0/5 å®Œæˆ</span>
              </div>
              <div class="card-body" style="padding: 0;">
                <ul class="task-list" id="taskList">
                  <li class="task-item" data-task="vocabulary">
                    <div class="task-checkbox" onclick="toggleTask('vocabulary')">
                      <span class="check-icon">âœ“</span>
                    </div>
                    <div class="task-content">
                      <div class="task-title">ğŸ“– è¯æ±‡å­¦ä¹  - å•†åŠ¡è¯æ±‡ (30è¯)</div>
                      <div class="task-meta">é¢„è®¡ 15 åˆ†é’Ÿ</div>
                    </div>
                    <a href="pages/vocabulary.html" class="task-action" id="taskBtn-vocabulary">å¼€å§‹å­¦ä¹ </a>
                  </li>
                  <li class="task-item" data-task="listening">
                    <div class="task-checkbox" onclick="toggleTask('listening')">
                      <span class="check-icon">âœ“</span>
                    </div>
                    <div class="task-content">
                      <div class="task-title">ğŸ‘‚ å¬åŠ›ç»ƒä¹  - TED æ¼”è®²ç‰‡æ®µ</div>
                      <div class="task-meta">é¢„è®¡ 15 åˆ†é’Ÿ</div>
                    </div>
                    <a href="pages/listening.html" class="task-action" id="taskBtn-listening">å¼€å§‹å­¦ä¹ </a>
                  </li>
                  <li class="task-item" data-task="reading">
                    <div class="task-checkbox" onclick="toggleTask('reading')">
                      <span class="check-icon">âœ“</span>
                    </div>
                    <div class="task-content">
                      <div class="task-title">ğŸ“š é˜…è¯»ç»ƒä¹  - å•†åŠ¡é‚®ä»¶èŒƒä¾‹</div>
                      <div class="task-meta">é¢„è®¡ 15 åˆ†é’Ÿ</div>
                    </div>
                    <a href="pages/reading.html" class="task-action" id="taskBtn-reading">å¼€å§‹å­¦ä¹ </a>
                  </li>
                  <li class="task-item" data-task="writing">
                    <div class="task-checkbox" onclick="toggleTask('writing')">
                      <span class="check-icon">âœ“</span>
                    </div>
                    <div class="task-content">
                      <div class="task-title">âœï¸ å†™ä½œç»ƒä¹  - è‡ªæˆ‘ä»‹ç»</div>
                      <div class="task-meta">é¢„è®¡ 20 åˆ†é’Ÿ</div>
                    </div>
                    <a href="pages/writing.html" class="task-action" id="taskBtn-writing">å¼€å§‹å­¦ä¹ </a>
                  </li>
                  <li class="task-item" data-task="test">
                    <div class="task-checkbox" onclick="toggleTask('test')">
                      <span class="check-icon">âœ“</span>
                    </div>
                    <div class="task-content">
                      <div class="task-title">ğŸ¯ æ¯æ—¥æµ‹éªŒ - Day 1 å°æµ‹</div>
                      <div class="task-meta">é¢„è®¡ 10 åˆ†é’Ÿ</div>
                    </div>
                    <a href="pages/test.html" class="task-action" id="taskBtn-test">å¼€å§‹æµ‹éªŒ</a>
                  </li>
                </ul>
              </div>
            </div>

            <!-- Check-in Button -->
            <div class="text-center animate-slide-up">
              <button class="checkin-btn" id="checkinBtn" onclick="doCheckin()">
                âœ… å®Œæˆä»Šæ—¥æ‰“å¡
              </button>
              <p class="text-muted mt-md" id="checkinHint">å®Œæˆä»»æ„ 3 é¡¹ä»»åŠ¡å³å¯æ‰“å¡</p>
            </div>
          </div>

          <!-- Sidebar -->
          <div class="dashboard-sidebar">
            <!-- Community Stats - ä»Šæ—¥å­¦ä¹ åŠ¨æ€ -->
            <div class="card animate-slide-up community-stats-card">
              <div class="card-header">
                <h3 class="card-title">
                  <span>ğŸ‘¥</span> ä»Šæ—¥å­¦ä¹ åŠ¨æ€
                </h3>
                <span class="live-dot"></span>
              </div>
              <div class="card-body">
                <div class="community-stats">
                  <div class="community-stat-item">
                    <div class="community-stat-icon completed">ğŸ‰</div>
                    <div class="community-stat-info">
                      <div class="community-stat-value" id="completedCount">--</div>
                      <div class="community-stat-label">äººå®Œæˆå­¦ä¹ </div>
                    </div>
                  </div>
                  <div class="community-stat-divider"></div>
                  <div class="community-stat-item">
                    <div class="community-stat-icon learning">ğŸ“–</div>
                    <div class="community-stat-info">
                      <div class="community-stat-value" id="learningCount">--</div>
                      <div class="community-stat-label">äººå‚ä¸å­¦ä¹ </div>
                    </div>
                  </div>
                </div>
                <div class="community-progress">
                  <div class="community-progress-bar">
                    <div class="community-progress-fill" id="communityProgressFill" style="width: 0%"></div>
                  </div>
                  <div class="community-progress-text">
                    <span id="completionRate">0%</span> å®Œæˆç‡
                  </div>
                </div>
                <div class="community-update-time">
                  <span>ğŸ”„</span> <span id="updateTime">æ›´æ–°ä¸­...</span>
                </div>
              </div>
            </div>

            <!-- Mini Calendar -->
            <div class="card animate-slide-up">
              <div class="card-header">
                <h3 class="card-title">
                  <span>ğŸ“…</span> æ‰“å¡æ—¥å†
                </h3>
                <span class="text-muted" id="currentMonth">2026å¹´2æœˆ</span>
              </div>
              <div class="card-body" style="padding: var(--spacing-sm);">
                <div class="calendar-weekdays">
                  <span>æ—¥</span>
                  <span>ä¸€</span>
                  <span>äºŒ</span>
                  <span>ä¸‰</span>
                  <span>å››</span>
                  <span>äº”</span>
                  <span>å…­</span>
                </div>
                <div class="calendar-days" id="calendarDays">
                  <!-- Generated by JS -->
                </div>
              </div>
            </div>

            <!-- Radar Chart -->
            <div class="card animate-slide-up">
              <div class="card-header">
                <h3 class="card-title">
                  <span>ğŸ“Š</span> èƒ½åŠ›é›·è¾¾å›¾
                </h3>
              </div>
              <div class="card-body">
                <div class="radar-container">
                  <canvas id="radarChart" width="250" height="250"></canvas>
                </div>
              </div>
            </div>

            <!-- Streak & Time -->
            <div class="card animate-slide-up">
              <div class="card-body">
                <div class="streak-display">
                  <div class="streak-fire">ğŸ”¥</div>
                  <div class="streak-number" id="streakDisplay">0</div>
                  <div class="streak-label">å¤©è¿ç»­å­¦ä¹ </div>
                </div>
                <hr style="border: none; border-top: 1px solid var(--border-color); margin: var(--spacing-md) 0;">
                <div class="study-time">
                  <span class="time-value" id="todayTime">0</span>
                  <span class="time-label">åˆ†é’Ÿ<br>ä»Šæ—¥å­¦ä¹ </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer style="text-align: center; padding: var(--spacing-lg); color: var(--text-muted); font-size: 0.875rem;">
      <p>English Mastery Â© 2026 | 30å¤©è¾¾æˆæ¯è¯­æ°´å¹³</p>
    </footer>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast"></div>

  <!-- Scripts -->
  <script src="js/auth.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/progress.js"></script>
  <script src="js/checkin.js"></script>
  <script src="js/app.js"></script>
  <script>
    // æ£€æŸ¥ç™»å½•çŠ¶æ€
    document.addEventListener('DOMContentLoaded', function() {
      if (!Auth.isLoggedIn()) {
        window.location.href = 'pages/auth.html';
        return;
      }
      
      // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
      const user = Auth.getCurrentUser();
      if (user) {
        document.getElementById('userName').textContent = user.name;
        document.getElementById('userEmail').textContent = user.email;
        document.getElementById('userAvatar').textContent = user.name.charAt(0).toUpperCase();
      }
    });
    
    // åˆ‡æ¢ç”¨æˆ·ä¸‹æ‹‰èœå•
    function toggleUserDropdown() {
      const dropdown = document.getElementById('userDropdown');
      dropdown.classList.toggle('show');
    }
    
    // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰èœå•
    document.addEventListener('click', function(e) {
      const userMenu = document.getElementById('userMenu');
      const dropdown = document.getElementById('userDropdown');
      if (userMenu && !userMenu.contains(e.target)) {
        dropdown.classList.remove('show');
      }
    });
    
    // é€€å‡ºç™»å½•
    function handleLogout() {
      Auth.logout();
      window.location.href = 'pages/auth.html';
    }
  </script>
</body>
</html>
