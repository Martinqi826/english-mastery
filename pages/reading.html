<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é˜…è¯»ç»ƒä¹  - English Mastery</title>
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .article-card {
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      overflow: hidden;
      margin-bottom: var(--spacing-lg);
      box-shadow: var(--shadow-md);
    }
    
    .article-header {
      padding: var(--spacing-lg);
      border-bottom: 1px solid var(--border-color);
    }
    
    .article-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: var(--spacing-sm);
    }
    
    .article-meta {
      display: flex;
      gap: var(--spacing-md);
      color: var(--text-muted);
      font-size: 0.875rem;
    }
    
    .article-content {
      padding: var(--spacing-xl);
      line-height: 1.8;
      font-size: 1.0625rem;
    }
    
    .article-content p {
      margin-bottom: var(--spacing-lg);
      text-align: justify;
    }
    
    .highlight-word {
      background: linear-gradient(transparent 60%, #FEF3C7 60%);
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .highlight-word:hover {
      background: #FDE68A;
    }
    
    .word-tooltip {
      position: fixed;
      background: var(--text-primary);
      color: white;
      padding: var(--spacing-md);
      border-radius: var(--radius-md);
      font-size: 0.875rem;
      max-width: 300px;
      z-index: 1000;
      box-shadow: var(--shadow-lg);
      display: none;
    }
    
    .word-tooltip.show {
      display: block;
    }
    
    .word-tooltip-word {
      font-weight: 600;
      margin-bottom: var(--spacing-xs);
    }
    
    .word-tooltip-phonetic {
      color: rgba(255,255,255,0.7);
      font-size: 0.75rem;
      margin-bottom: var(--spacing-sm);
    }
    
    .reading-tools {
      display: flex;
      gap: var(--spacing-md);
      padding: var(--spacing-md) var(--spacing-lg);
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border-color);
    }
    
    .tool-btn {
      padding: var(--spacing-sm) var(--spacing-md);
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .tool-btn:hover {
      border-color: var(--primary-color);
    }
    
    .tool-btn.active {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }
    
    .comprehension-section {
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      padding: var(--spacing-xl);
      margin-top: var(--spacing-lg);
    }
    
    .question-card {
      padding: var(--spacing-lg);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      margin-bottom: var(--spacing-md);
    }
    
    .question-text {
      font-weight: 500;
      margin-bottom: var(--spacing-md);
    }
    
    .answer-options {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
    }
    
    .answer-option {
      padding: var(--spacing-md);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .answer-option:hover {
      border-color: var(--primary-color);
      background: var(--bg-tertiary);
    }
    
    .answer-option.selected {
      border-color: var(--primary-color);
      background: var(--primary-light);
      color: white;
    }
    
    .answer-option.correct {
      border-color: var(--success-color);
      background: var(--success-color);
      color: white;
    }
    
    .answer-option.wrong {
      border-color: var(--danger-color);
      background: var(--danger-color);
      color: white;
    }
    
    .articles-list {
      display: grid;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-xl);
    }
    
    .article-item {
      background: var(--bg-primary);
      border-radius: var(--radius-md);
      padding: var(--spacing-lg);
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
    }
    
    .article-item:hover {
      border-color: var(--primary-color);
      transform: translateY(-2px);
    }
    
    .article-item.completed {
      border-color: var(--success-color);
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent);
    }
    
    .article-icon {
      font-size: 2rem;
    }
    
    .article-info {
      flex: 1;
    }
    
    .article-item-title {
      font-weight: 600;
      margin-bottom: var(--spacing-xs);
    }
    
    .article-item-meta {
      font-size: 0.875rem;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <span class="logo-icon">ğŸ¯</span>
            <span>English Mastery</span>
          </div>
          <div class="day-badge" id="dayBadge">Day 1 / 30</div>
        </div>
      </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
      <div class="container">
        <ul class="nav-list">
          <li class="nav-item"><a href="../index.html" class="nav-link"><span>ğŸ“Š</span> ä»ªè¡¨ç›˜</a></li>
          <li class="nav-item"><a href="vocabulary.html" class="nav-link"><span>ğŸ“–</span> è¯æ±‡å­¦ä¹ </a></li>
          <li class="nav-item"><a href="listening.html" class="nav-link"><span>ğŸ‘‚</span> å¬åŠ›è®­ç»ƒ</a></li>
          <li class="nav-item"><a href="reading.html" class="nav-link active"><span>ğŸ“š</span> é˜…è¯»ç»ƒä¹ </a></li>
          <li class="nav-item"><a href="writing.html" class="nav-link"><span>âœï¸</span> å†™ä½œç»ƒä¹ </a></li>
          <li class="nav-item"><a href="test.html" class="nav-link"><span>ğŸ¯</span> æµ‹è¯•è¯„ä¼°</a></li>
          <li class="nav-item"><a href="calendar.html" class="nav-link"><span>ğŸ“…</span> æ‰“å¡æ—¥å†</a></li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <h1 style="margin-bottom: var(--spacing-lg);">ğŸ“š é˜…è¯»ç»ƒä¹ </h1>
        
        <!-- Articles List -->
        <div class="card" style="margin-bottom: var(--spacing-xl);">
          <div class="card-header">
            <h2 class="card-title"><span>ğŸ“„</span> ä»Šæ—¥é˜…è¯»ææ–™</h2>
            <span class="text-muted" id="readingProgress">0/3 å®Œæˆ</span>
          </div>
          <div class="card-body">
            <div class="articles-list" id="articlesList">
              <div class="article-item" onclick="selectArticle(0)">
                <div class="article-icon">ğŸ“§</div>
                <div class="article-info">
                  <div class="article-item-title">Professional Email: Project Update</div>
                  <div class="article-item-meta">å•†åŠ¡é‚®ä»¶ | çº¦300è¯ | ä¸­ç­‰éš¾åº¦</div>
                </div>
                <span id="article-status-0">â—‹</span>
              </div>
              <div class="article-item" onclick="selectArticle(1)">
                <div class="article-icon">ğŸ“Š</div>
                <div class="article-info">
                  <div class="article-item-title">Business Report: Q4 Performance</div>
                  <div class="article-item-meta">å•†åŠ¡æŠ¥å‘Š | çº¦400è¯ | ä¸­ç­‰éš¾åº¦</div>
                </div>
                <span id="article-status-1">â—‹</span>
              </div>
              <div class="article-item" onclick="selectArticle(2)">
                <div class="article-icon">ğŸ“°</div>
                <div class="article-info">
                  <div class="article-item-title">Industry News: Tech Trends 2026</div>
                  <div class="article-item-meta">è¡Œä¸šæ–°é—» | çº¦350è¯ | è¾ƒéš¾</div>
                </div>
                <span id="article-status-2">â—‹</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Article Reader -->
        <div class="article-card" id="articleCard">
          <div class="article-header">
            <h2 class="article-title" id="articleTitle">Professional Email: Project Update</h2>
            <div class="article-meta">
              <span>ğŸ“§ å•†åŠ¡é‚®ä»¶</span>
              <span>ğŸ“– çº¦300è¯</span>
              <span>â±ï¸ é¢„è®¡5åˆ†é’Ÿ</span>
            </div>
          </div>
          
          <div class="reading-tools">
            <button class="tool-btn" onclick="toggleHighlight()">ğŸ” é«˜äº®ç”Ÿè¯</button>
            <button class="tool-btn" onclick="increaseFontSize()">A+</button>
            <button class="tool-btn" onclick="decreaseFontSize()">A-</button>
          </div>
          
          <div class="article-content" id="articleContent">
            <p>Dear Team,</p>
            
            <p>I hope this email finds you well. I wanted to provide you with a <span class="highlight-word" data-word="comprehensive" data-meaning="å…¨é¢çš„ï¼Œç»¼åˆçš„" data-phonetic="/ËŒkÉ‘ËmprÉªËˆhensÉªv/">comprehensive</span> update on our Q4 project <span class="highlight-word" data-word="initiatives" data-meaning="å€¡è®®ï¼Œè®¡åˆ’" data-phonetic="/ÉªËˆnÉªÊƒÉ™tÉªvz/">initiatives</span> and share some exciting developments.</p>
            
            <p>First, I'm pleased to announce that we have successfully completed the <span class="highlight-word" data-word="preliminary" data-meaning="åˆæ­¥çš„ï¼Œé¢„å¤‡çš„" data-phonetic="/prÉªËˆlÉªmÉªneri/">preliminary</span> phase of our digital transformation project. The team has demonstrated <span class="highlight-word" data-word="exceptional" data-meaning="æ°å‡ºçš„ï¼Œå“è¶Šçš„" data-phonetic="/ÉªkËˆsepÊƒÉ™nl/">exceptional</span> <span class="highlight-word" data-word="dedication" data-meaning="å¥‰çŒ®ï¼Œä¸“æ³¨" data-phonetic="/ËŒdedÉªËˆkeÉªÊƒn/">dedication</span> and has <span class="highlight-word" data-word="exceeded" data-meaning="è¶…è¿‡ï¼Œè¶…è¶Š" data-phonetic="/ÉªkËˆsiËdÉªd/">exceeded</span> our initial expectations.</p>
            
            <p>Moving forward, we will be <span class="highlight-word" data-word="implementing" data-meaning="å®æ–½ï¼Œæ‰§è¡Œ" data-phonetic="/ËˆÉªmplÉªmentÉªÅ‹/">implementing</span> several key changes to <span class="highlight-word" data-word="streamline" data-meaning="ç²¾ç®€ï¼Œä½¿é«˜æ•ˆ" data-phonetic="/ËˆstriËmlaÉªn/">streamline</span> our <span class="highlight-word" data-word="workflow" data-meaning="å·¥ä½œæµç¨‹" data-phonetic="/ËˆwÉœËrkfloÊŠ/">workflow</span>. These include the adoption of new project management tools and the <span class="highlight-word" data-word="establishment" data-meaning="å»ºç«‹ï¼Œè®¾ç«‹" data-phonetic="/ÉªËˆstÃ¦blÉªÊƒmÉ™nt/">establishment</span> of weekly cross-functional meetings.</p>
            
            <p>I would like to <span class="highlight-word" data-word="emphasize" data-meaning="å¼ºè°ƒ" data-phonetic="/ËˆemfÉ™saÉªz/">emphasize</span> the importance of maintaining clear communication channels throughout this <span class="highlight-word" data-word="transition" data-meaning="è¿‡æ¸¡ï¼Œè½¬å˜" data-phonetic="/trÃ¦nËˆzÉªÊƒn/">transition</span> period. Please feel free to reach out if you have any questions or concerns.</p>
            
            <p>Best regards,<br>Project Manager</p>
          </div>
        </div>
        
        <!-- Comprehension Questions -->
        <div class="comprehension-section" id="comprehensionSection">
          <h3 class="card-title" style="margin-bottom: var(--spacing-lg);"><span>â“</span> é˜…è¯»ç†è§£</h3>
          
          <div id="questionsContainer">
            <div class="question-card" data-question="0">
              <div class="question-text">1. What is the main purpose of this email?</div>
              <div class="answer-options">
                <div class="answer-option" onclick="selectAnswer(0, 0)">A. To request more resources</div>
                <div class="answer-option" onclick="selectAnswer(0, 1)">B. To provide a project update</div>
                <div class="answer-option" onclick="selectAnswer(0, 2)">C. To announce layoffs</div>
                <div class="answer-option" onclick="selectAnswer(0, 3)">D. To schedule a meeting</div>
              </div>
            </div>
            
            <div class="question-card" data-question="1">
              <div class="question-text">2. What has the team accomplished so far?</div>
              <div class="answer-options">
                <div class="answer-option" onclick="selectAnswer(1, 0)">A. Completed the entire project</div>
                <div class="answer-option" onclick="selectAnswer(1, 1)">B. Completed the preliminary phase</div>
                <div class="answer-option" onclick="selectAnswer(1, 2)">C. Started the planning process</div>
                <div class="answer-option" onclick="selectAnswer(1, 3)">D. Hired new team members</div>
              </div>
            </div>
            
            <div class="question-card" data-question="2">
              <div class="question-text">3. What changes will be implemented?</div>
              <div class="answer-options">
                <div class="answer-option" onclick="selectAnswer(2, 0)">A. New office location</div>
                <div class="answer-option" onclick="selectAnswer(2, 1)">B. New project management tools and weekly meetings</div>
                <div class="answer-option" onclick="selectAnswer(2, 2)">C. Salary increases</div>
                <div class="answer-option" onclick="selectAnswer(2, 3)">D. Remote work policy</div>
              </div>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: var(--spacing-lg);">
            <button class="btn btn-primary btn-lg" id="submitBtn" onclick="submitAnswers()">æäº¤ç­”æ¡ˆ</button>
          </div>
          
          <div id="resultSection" class="hidden" style="text-align: center; padding: var(--spacing-xl);">
            <div style="font-size: 4rem; margin-bottom: var(--spacing-lg);">ğŸ‰</div>
            <h2>é˜…è¯»å®Œæˆï¼</h2>
            <p class="text-muted mt-md">æ­£ç¡®ç‡: <span id="accuracy">0</span>%</p>
            <button class="btn btn-primary btn-lg mt-lg" onclick="location.href='../index.html'">è¿”å›ä»ªè¡¨ç›˜</button>
          </div>
        </div>
      </div>
    </main>
    
    <!-- Word Tooltip -->
    <div class="word-tooltip" id="wordTooltip">
      <div class="word-tooltip-word" id="tooltipWord"></div>
      <div class="word-tooltip-phonetic" id="tooltipPhonetic"></div>
      <div class="word-tooltip-meaning" id="tooltipMeaning"></div>
    </div>
  </div>

  <script src="../js/storage.js"></script>
  <script>
    const articles = [
      {
        title: "Professional Email: Project Update",
        category: "å•†åŠ¡é‚®ä»¶",
        words: 300,
        correctAnswers: [1, 1, 1]
      },
      {
        title: "Business Report: Q4 Performance",
        category: "å•†åŠ¡æŠ¥å‘Š",
        words: 400,
        correctAnswers: [1, 1, 1]
      },
      {
        title: "Industry News: Tech Trends 2026",
        category: "è¡Œä¸šæ–°é—»",
        words: 350,
        correctAnswers: [1, 1, 1]
      }
    ];
    
    let currentArticle = 0;
    let userAnswers = [-1, -1, -1];
    let completedArticles = [];
    let fontSize = 16;
    
    document.addEventListener('DOMContentLoaded', function() {
      updateDayBadge();
      loadProgress();
      updateUI();
      setupHighlightWords();
    });
    
    function updateDayBadge() {
      const currentDay = Storage.getCurrentDay();
      document.getElementById('dayBadge').textContent = `Day ${currentDay} / 30`;
    }
    
    function loadProgress() {
      const saved = localStorage.getItem('em_reading_progress');
      if (saved) {
        const data = JSON.parse(saved);
        if (data.date === Storage.getTodayString()) {
          completedArticles = data.completedArticles || [];
        }
      }
    }
    
    function saveProgress() {
      localStorage.setItem('em_reading_progress', JSON.stringify({
        date: Storage.getTodayString(),
        completedArticles
      }));
    }
    
    function updateUI() {
      completedArticles.forEach(index => {
        const item = document.querySelectorAll('.article-item')[index];
        const status = document.getElementById(`article-status-${index}`);
        if (item) item.classList.add('completed');
        if (status) status.textContent = 'âœ…';
      });
      
      document.getElementById('readingProgress').textContent = `${completedArticles.length}/3 å®Œæˆ`;
    }
    
    function selectArticle(index) {
      currentArticle = index;
      userAnswers = [-1, -1, -1];
      // å®é™…åº”ç”¨ä¸­è¿™é‡Œä¼šåŠ è½½ä¸åŒçš„æ–‡ç« å†…å®¹
      document.getElementById('articleTitle').textContent = articles[index].title;
      
      // é‡ç½®é—®é¢˜é€‰é¡¹
      document.querySelectorAll('.answer-option').forEach(opt => {
        opt.classList.remove('selected', 'correct', 'wrong');
      });
      
      document.getElementById('questionsContainer').classList.remove('hidden');
      document.getElementById('submitBtn').classList.remove('hidden');
      document.getElementById('resultSection').classList.add('hidden');
    }
    
    function setupHighlightWords() {
      const words = document.querySelectorAll('.highlight-word');
      const tooltip = document.getElementById('wordTooltip');
      
      words.forEach(word => {
        word.addEventListener('mouseenter', function(e) {
          const rect = this.getBoundingClientRect();
          document.getElementById('tooltipWord').textContent = this.dataset.word;
          document.getElementById('tooltipPhonetic').textContent = this.dataset.phonetic;
          document.getElementById('tooltipMeaning').textContent = this.dataset.meaning;
          
          tooltip.style.left = rect.left + 'px';
          tooltip.style.top = (rect.bottom + 10) + 'px';
          tooltip.classList.add('show');
        });
        
        word.addEventListener('mouseleave', function() {
          tooltip.classList.remove('show');
        });
      });
    }
    
    function selectAnswer(questionIndex, answerIndex) {
      userAnswers[questionIndex] = answerIndex;
      
      const card = document.querySelector(`.question-card[data-question="${questionIndex}"]`);
      card.querySelectorAll('.answer-option').forEach((opt, i) => {
        if (i === answerIndex) {
          opt.classList.add('selected');
        } else {
          opt.classList.remove('selected');
        }
      });
    }
    
    function submitAnswers() {
      const article = articles[currentArticle];
      let correct = 0;
      
      userAnswers.forEach((answer, i) => {
        const card = document.querySelector(`.question-card[data-question="${i}"]`);
        const options = card.querySelectorAll('.answer-option');
        
        if (answer === article.correctAnswers[i]) {
          options[answer].classList.add('correct');
          correct++;
        } else {
          if (answer >= 0) {
            options[answer].classList.add('wrong');
          }
          options[article.correctAnswers[i]].classList.add('correct');
        }
      });
      
      const accuracy = Math.round((correct / 3) * 100);
      
      if (!completedArticles.includes(currentArticle)) {
        completedArticles.push(currentArticle);
        saveProgress();
      }
      
      document.getElementById('submitBtn').classList.add('hidden');
      document.getElementById('resultSection').classList.remove('hidden');
      document.getElementById('accuracy').textContent = accuracy;
      
      updateUI();
      
      // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨å®Œæˆ
      if (completedArticles.length >= 3) {
        Storage.updateTodayTask('reading', true);
        Storage.addStudyTime(15);
        
        const progress = Storage.getProgress();
        progress.reading = Math.min(100, (progress.reading || 38) + 2);
        Storage.setProgress(progress);
      }
    }
    
    function increaseFontSize() {
      fontSize = Math.min(24, fontSize + 2);
      document.getElementById('articleContent').style.fontSize = fontSize + 'px';
    }
    
    function decreaseFontSize() {
      fontSize = Math.max(12, fontSize - 2);
      document.getElementById('articleContent').style.fontSize = fontSize + 'px';
    }
    
    function toggleHighlight() {
      const words = document.querySelectorAll('.highlight-word');
      words.forEach(word => {
        word.style.background = word.style.background ? '' : 'transparent';
      });
    }
  </script>
</body>
</html>
